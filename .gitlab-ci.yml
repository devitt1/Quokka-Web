image: registry.gitlab.com/gitlab-org/cloud-deploy/aws-base:latest

cache:
  paths:
    - node_modules/
    - .yarn

variables:
  REGION: ap-southeast-2

before_script:
  - sudo apt update
  - sudo apt install yarn
#  - npm install --global yarn
#  - yarn --version
#  - yarn install

stages:
  - deploy

deploy:
  stage: deploy
  only:
    refs:
      - develop
  script:
    - CI=false yarn build
    - aws --region $REGION s3 cp --recursive ./build/ s3://theq-webapp
